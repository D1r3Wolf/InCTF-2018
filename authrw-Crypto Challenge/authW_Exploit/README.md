# authw
* For this we have to make `user=admin & role=admin`.But the input is only taking for user.
* Ok! But why can't we inject the `role=admin` using username input.
* There is No need of `AES CBC bit flipping attack`
### Exploiting
* ![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/www.png)
* But in `register function` we can observe the `username = "username=" + username + ":role=ordinary"`
* It is adding `'username='` to our input .So there is no need of 'username=' string
* ##### Payload = 'admin:role=admin\x07\x07\x07\x07\x07\x07\x07' 
![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/aww.png)
* If we use Payload as Input Then it returns `iv+encypt(pad('username=admin:role=admin\x07\x07\x07\x07\x07\x07\x07'+':role=ordinary'))` in hex as cookie
* **It is a Block Cipher encryption**
> 1st Block : (iv)<br>
> 2nd Block : ('username=admin:r')<br>
> 3rd Block : ('ole=admin\x07\x07\x07\x07\x07\x07\x07')<br>
> 4th Block : (':role=ordinary\x02\x02')<br>
* `'\x07'\*7` padding helped us to move the `':role=ordinary'` into 4th Block.
* So In order to Terminate `':role=ordinary'` part we can Simply remove the 4th block of cookie like `cookie = cookie[:96]`
* Now `cookie = iv+encryption('username=admin:role=admin\x07\x07\x07\x07\x07\x07\x07')`
* After Decrypting the Cookie It returns `'username=admin:role=admin'` . Because of unpadding `'\x07'` will terminates
![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/aaa.png)
* That's it. Now we can use this cookie To get **Writing authorization**. 
![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ra1.png)
* **[+] Welcome real Admin!** We are real Admin now.wow It's awesome.
![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ra2.png)
![aw1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ra3.png)
* We also grabbed the Writing Rights. Cool!.... 
### Code Implimentation :: [exploit.py](https://github.com/Ajay-Aj-00/Test/blob/master/authW_Exploit/exploit.py)
