# authr
* For this We have to make the `user=='admin'` through the given cookie.
> The Vulnerability here is The Encrytion is Providing the IV as cookie[:16] , So if we change the First part(cookie[:16]) which will leads to **XOR** with Second part and changes the Corresponding Indexes
* This is [AES CBC bit flipping attack](https://masterpessimistaa.wordpress.com/2017/05/03/cbc-bit-flipping-attack/)
* It's Nothing but Simply editing the cookie(Encryted message) to get required message after Decryption
> ms = normal message <br>
> ck = encrypted message<br>
> Let ms[20] is 'A' and if we want ms[20] as 'a' after Decryption of ck.<br>
> Then change the ck as **ck[4]=ck[4]^'A'^'a'**. Because corresponding index for 20 in First part is 4.<br>
> After decrypting ck. It leads to `ck[20] as 'a'` But The First Part ck[:16] will change.<br>
> It wont rise a problem because it's a garbage String.<br>
### Exploitation
* let's give the username as 'Admin' ('Admin'!='admin').So No Problem.
![ar1](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ar1.png)
* It returns us the cookie
* <b>Now time to workout with cookie :)</b>
![ar2](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ar2.png)
* ck[9] is beacuse In the str(IV+"username=Admin:role=ordinary") 'A' is in **25** index & its correspondence is **9**
* We got the cookie.Now we can login using this cookie to get the **FLAG**
![ar3](https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/ar3.png)
* **That's it here we got the Flag**<br>
### Code Implimentation :: [exploit.py](https://github.com/Ajay-Aj-00/Test/blob/master/authR_Exploit/exploit.py)
